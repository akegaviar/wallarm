.. _installation-postanalytics-ru:

===================================================
Установите модуль постаналитики на отдельный сервер
===================================================

.. include:: /ru/include-ru/installation-options-ru.rst

Для установки модуля постаналитики вам потребуется выполнить следующие
действия:

#. Добавить репозитории Wallarm, из которых вы загрузите пакеты.
#. Установить пакеты Wallarm.
#. Настроить модуль постаналитики.
#. Подключить модуль постаналтики к облаку Wallarm.
#. Изменить адреса Tarantool для модулей аналитики.

Добавьте репозитории Wallarm
~~~~~~~~~~~~~~~~~~~~~~~~~~~~

Установка и обновление модуля постаналитики происходит из репозиториев Wallarm.

В зависимости от вашей операционной системы, выполните одну из следующих команд:

.. include:: /ru/include-ru/add-repo-ru.rst

.. include:: /ru/include-ru/access-repo-ru.rst

Установите пакеты Wallarm
~~~~~~~~~~~~~~~~~~~~~~~~~

Установите модуль NGINX-Wallarm и необходимые скрипты для взаимодействия с
облаком Wallarm.

.. include:: /ru/include-ru/install-package-postanalytics-ru.rst

Настройте модуль постаналитики
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

.. include:: /ru/include-ru/configure-postanalytics-ru.rst

Подключите модуль постаналитики к облаку Wallarm
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

Обеспечьте доступ к облаку, чтобы подсистема постаналитики могла обновлять
правила обработки, выгружать метрики и данные об атаках.

.. code-block:: command

   /usr/share/wallarm-common/addnode --no-sync

Во время старта скрипт запросит логин и пароль. Введите данные, которые вы
используете для входа в веб-интерфейс `https://my.wallarm.com <https://my.wallarm.com>`_.

Ваша учетная запись должна иметь привилегии на подключение нового фильтрующего узла.
Если таких привилегий нет, скрипт сообщит об ошибке.

.. note:: Для взаимодействия с облаком у сервера должен быть открыт доступ к
          api.wallarm.com:444. В случае проблем убедитесь, что он не ограничен
          файрволом.

Измените адреса Tarantool для модулей аналитики
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

Если конфигурационный файл Tarantool настроен принимать соединения на адресах,
отличных от ``0.0.0.0`` или ``127.0.0.1``, то необходимо указать эти адреса
в ``/etc/wallarm/node.yaml``:

.. code-block:: conf

    ---
    hostname: <node hostname>
    uuid: <node uuid>
    secret: <node secret>
    tarantool:
      host: <IP address of Tarantool host>
      port: 3313

На этом установка постаналитики завершена.
